# 🌪 Typhoon Eyewall 3D Modeling using Neural Radiance Fields

本プロジェクトは、**台風航空機観測映像からNeRF（神経放射輝度場）を用いて3D再構成と高度測量**を行った研究成果です。  
琉球大学大学院工学研究科 知能機械システムプログラムにおける修士研究として実施しました。

---

## 🏷 概要

- **目的**: 航空機から撮影した台風内部映像をAIで3D再構成し、雲頂高度を精密に測定する。  
- **背景**: 衛星観測では分解能に限界があり、台風内部の雲構造把握が困難。  
  → 航空機観測とNeRF技術を組み合わせ、実空間的な立体復元を試みた。  
- **成果**: 再構成した点群から得た雲頂高度が、JAXAひまわり衛星の解析値と高精度に一致。

---

## ⚙️ 技術スタック

| 種類 | 使用技術 |
|------|------------|
| 言語 | Python 3.9 |
| 主要ライブラリ | OpenCV, COLMAP, Open3D, NumPy, Matplotlib |
| 深層学習モデル | Instant-NGP (Neural Radiance Fields) |
| 測量ツール | CloudCompare |
| データ | 航空機搭載カメラ映像（2021年 台風Mindulle観測） |

---

## 🧠 処理フロー

1. **画像前処理**（`2点1と2点3の前処理.ipynb`）  
   - 歪み補正・輝度補正・リサイズ。
2. **カメラ座標推定**（`2点2の画像の前処理と2点3のカメラ座標推定.ipynb`）  
   - COLMAPにより外部・内部パラメータ推定。
3. **NeRF学習**（`2点4のInstantNGPの学習.ipynb`）  
   - `colmap2nerf2.py`で生成した`transforms.json`を使用し学習。
4. **点群生成**（`2点5の点群作成.ipynb`）  
   - Instant-NGP出力からPLY点群生成。
5. **高度測量**（`2点6のCloudCompareを用いた点群測量.ipynb`）  
   - CloudCompareでスケール調整し、衛星観測値と比較。

---

## 📂 フォルダ構成（提案）


---

## 🔍 各スクリプト概要

| ファイル | 内容 |
|----------|------|
| `colmap2nerf2.py` | COLMAPのカメラパラメータをNeRF形式に変換。 |
| `run2.py` | Instant-NGP学習と出力管理スクリプト。 |
| `.ipynb`群 | 各段階（前処理〜測量）の手順ノートブック。 |
| `base_cam.json` / `transforms.json` | カメラ姿勢・パラメータ情報。 |

> ⚠️ 一部スクリプトではパスやファイル名がハードコーディングされています。  
> `# 修正候補:` コメントでエラー発生箇所を明示しています。

---

## 📈 成果と考察

- 雲頂高度は、**JAXAひまわりデータの推定値と平均誤差±100m以内**で一致。  
- 雄大雲（積乱雲上部構造）の平均高度は、ドロップゾンデ観測の融解層（相対湿度100%）と同等。  
- NeRFを用いることで、従来困難だった**航空機からの立体的気象構造解析**が可能に。

---

## ✨ 今後の展望

- NeRF学習の高速化・少数画像対応の検証  
- 雲種分類モデル（SegNeRFなど）との統合  
- 気象庁やJAXAデータとの自動比較パイプライン構築  
- 災害解析・気象教育用途への応用  

---

## 📚 引用・参考文献
- Müller, T. et al. (2022). *Instant Neural Graphics Primitives with a Multiresolution Hash Encoding.*  
- 山田広幸ほか (2023). 日本気象学会講演予稿集.  
- JAXA ひまわりデータアーカイブ.  

---

© 2024 Takuya Mori  
琉球大学大学院 理工学研究科 知能機械システムプログラム
